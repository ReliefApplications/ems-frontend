<safe-modal>
  <h1 mat-dialog-title>{{ 'components.emailPreview.title' | translate }}</h1>
  <div mat-dialog-content>
    <form class="flex flex-col gap-4" [formGroup]="form" *ngIf="form">
      <mat-form-field>
        <mat-label>{{
          'components.emailPreview.subject' | translate
        }}</mat-label>
        <input matInput formControlName="subject" type="text" />
        <mat-error *ngIf="this.form.controls.subject.hasError('required')">
          {{ 'components.emailPreview.errors.missingSubject' | translate }}
        </mat-error>
      </mat-form-field>
      <mat-form-field>
        <mat-label>{{ 'components.emailPreview.from' | translate }}</mat-label>
        <input matInput formControlName="from" type="text" />
      </mat-form-field>
      <mat-form-field id="previewEmailTo">
        <mat-label>{{ 'components.emailPreview.to' | translate }}</mat-label>
        <mat-chip-list #chipList formControlName="to">
          <mat-chip
            *ngFor="let email of emails"
            [selectable]="true"
            [removable]="true"
            (removed)="removeEmail(email)"
          >
            {{ email }}
            <safe-icon matChipRemove icon="cancel" [size]="18"></safe-icon>
          </mat-chip>
          <input
            #emailsInput
            [matChipInputFor]="chipList"
            [matChipInputSeparatorKeyCodes]="separatorKeysCodes"
            (focusout)="addEmail($event)"
            (matChipInputTokenEnd)="addEmail($event)"
          />
        </mat-chip-list>
        <mat-error>{{ errorMessage() | translate }}</mat-error>
      </mat-form-field>
      <kendo-fileselect
        class="mb-4"
        [multiple]="true"
        formControlName="files"
      ></kendo-fileselect>
      <editor [init]="editor" formControlName="html"></editor>
    </form>
  </div>
  <div mat-dialog-actions align="end">
    <safe-button mat-dialog-close>
      {{ 'common.dismiss' | translate }}
    </safe-button>
    <safe-button
      category="secondary"
      variant="primary"
      [mat-dialog-close]="form.value"
      cdkFocusInitial
      [disabled]="!form.valid"
    >
      {{ 'common.send' | translate }}
    </safe-button>
  </div>
</safe-modal>
