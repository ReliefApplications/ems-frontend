<ng-container *ngIf="form">
  <div class="flex flex-col gap-2" [formGroup]="form">
    <!-- First Date -->
    <ng-container [formGroup]="$any(filters.at(0))">
      <kendo-dropdownlist
        [data]="operatorsList"
        [valuePrimitive]="true"
        textField="text"
        valueField="value"
        formControlName="operator"
      >
      </kendo-dropdownlist>

      <div class="flex">
        <kendo-textbox
          *ngIf="firstDateMode === 'expression'"
          [style.width.px]="300"
          [clearButton]="true"
          formControlName="value"
        ></kendo-textbox>
        <kendo-datepicker
          *ngIf="firstDateMode === 'date'"
          formControlName="value"
          [popupSettings]="popupSettings"
        ></kendo-datepicker>

        <button
          type="button"
          kendoButton
          icon="refresh"
          [title]="
            (firstDateMode === 'expression'
              ? 'components.queryBuilder.tooltip.filter.date.usePicker'
              : 'components.queryBuilder.tooltip.filter.date.useExpression'
            ) | translate
          "
          (click)="
            $event.stopPropagation();
            firstDateMode =
              firstDateMode === 'expression' ? 'date' : 'expression'
          "
        ></button>
      </div>
    </ng-container>

    <!-- Filter logic -->
    <kendo-dropdownlist
      formControlName="logic"
      [data]="logics"
      [valuePrimitive]="true"
      textField="text"
      valueField="value"
      class="k-filter-and"
    ></kendo-dropdownlist>

    <!-- Second Date -->
    <ng-container [formGroup]="$any(filters.at(1))">
      <kendo-dropdownlist
        [data]="operatorsList"
        [valuePrimitive]="true"
        textField="text"
        valueField="value"
        formControlName="operator"
      >
      </kendo-dropdownlist>

      <div class="flex">
        <kendo-textbox
          *ngIf="secondDateMode === 'expression'"
          [style.width.px]="300"
          [clearButton]="true"
          formControlName="value"
        ></kendo-textbox>
        <kendo-datepicker
          *ngIf="secondDateMode === 'date'"
          formControlName="value"
          [popupSettings]="popupSettings"
        ></kendo-datepicker>

        <button
          type="button"
          kendoButton
          icon="refresh"
          [title]="
            (secondDateMode === 'expression'
              ? 'components.queryBuilder.tooltip.filter.date.usePicker'
              : 'components.queryBuilder.tooltip.filter.date.useExpression'
            ) | translate
          "
          (click)="
            $event.stopPropagation();
            secondDateMode =
              secondDateMode === 'expression' ? 'date' : 'expression'
          "
        ></button>
      </div>
    </ng-container>
  </div>
</ng-container>
