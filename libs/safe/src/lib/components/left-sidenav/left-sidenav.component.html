<section class="pt-2 block">
  <ng-container *ngFor="let group of navGroups; let i = index" class="h-full">
    <div class="sidenav-header">
      {{ group.name }}
      <safe-button
        *ngIf="appLayout && canAddPage"
        [isIcon]="true"
        icon="add"
        variant="grey"
        [uiTooltip]="'models.page.add' | translate"
        routerLink="./add-page"
        (click)="largeDevice ? null : nav.toggle()"
      ></safe-button>
    </div>
    <div
      cdkDropList
      (cdkDropListDropped)="drop($event, group)"
      class="overflow-hidden"
      [class]="
        appLayout
          ? canAddPage
            ? largeDevice
              ? 'app-sidenav-add-page'
              : 'app-sidenav-phone-add-page'
            : largeDevice
            ? 'app-sidenav'
            : 'app-sidenav-phone'
          : ''
      "
    >
      <!-- Classes determine nav-list height for application layout -->
      <ul>
        <ng-container *ngFor="let item of group.navItems">
          <div cdkDrag [cdkDragDisabled]="!item.orderable">
            <li class="nav-item">
              <a
                [routerLink]="item.path"
                routerLinkActive="active-link"
                (click)="largeDevice ? null : nav.toggle()"
                [class]="item.class ? item.class : ''"
              >
                <ui-icon [icon]="item.icon"></ui-icon>
                <div class="nav-text" [uiTooltip]="item.name">
                  {{ item.name }}
                </div>
              </a>
              <div
                class="nav-actions items-center"
                *ngIf="item.action || item.orderable"
              >
                <button
                  mat-icon-button
                  class="nav-action"
                  *ngIf="item.action"
                  (click)="onClick(item.action.callback, $event)"
                >
                  <ui-icon
                    uiTooltip="{{ item.action.toolTip }}"
                    matTooltipPosition="left"
                    [icon]="item.action.icon"
                  ></ui-icon>
                </button>
                <button
                  mat-icon-button
                  cdkDragHandle
                  class="nav-item-handle"
                  *ngIf="item.orderable"
                >
                  <ui-icon [icon]="'drag_indicator'"></ui-icon>
                </button>
              </div>
            </li>
            <!-- Preview when dragging element -->
            <li *cdkDragPreview class="nav-item bg-white shadow-2lg rounded-lg">
              <a [class]="item.class ? item.class : ''">
                <ui-icon [icon]="'drag_indicator'"></ui-icon>
                <div class="pl-2">{{ item.name }}</div>
              </a>
            </li>
          </div>
        </ng-container>
      </ul>
    </div>
    <ng-container *ngIf="appLayout && canAddPage">
      <div class="flex flex-col items-center w-full absolute bottom-0">
        <safe-divider class="m-0"></safe-divider>
        <safe-button
          class="my-4"
          icon="add"
          category="secondary"
          variant="primary"
          routerLink="./add-page"
          (click)="largeDevice ? null : nav.toggle()"
        >
          {{ 'models.page.add' | translate }}
        </safe-button>
      </div>
    </ng-container>
    <safe-divider class="m-0" *ngIf="i < navGroups.length - 1"></safe-divider>
  </ng-container>
</section>
