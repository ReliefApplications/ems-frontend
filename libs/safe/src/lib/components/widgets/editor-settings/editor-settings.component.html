<ng-container *ngIf="tileForm">
  <ui-tabs class="grow" [vertical]="true">
    <!-- Main Parameters -->
    <ui-tab>
      <ng-container ngProjectAs="label">
        <ui-icon
          icon="format_color_text"
          [size]="24"
          [uiTooltip]="'components.widget.settings.editor.title' | translate"
        ></ui-icon>
        <span>{{ 'components.widget.settings.editor.title' | translate }}</span>
      </ng-container>
      <form [formGroup]="tileForm">
        <div class="flex flex-col">
          <div uiFormFieldDirective>
            <label>{{ 'common.title' | translate }}</label>
            <input formControlName="title" type="string" />
          </div>
        </div>
        <editor [init]="editor" formControlName="text"></editor>
      </form>
    </ui-tab>
    <!-- Preview -->
    <ui-tab *ngIf="tileForm.value">
      <ng-container ngProjectAs="label">
        <ui-icon icon="preview" [size]="24"></ui-icon>
        <span>{{
          'components.widget.settings.summaryCard.card.preview.title'
            | translate
        }}</span>
      </ng-container>
      <safe-editor
        #widgetContent
        class="flex-1 h-full w-full"
        [settings]="tile.settings"
      >
      </safe-editor>
    </ui-tab>
    <!-- Resource and record selection  -->
    <ui-tab>
      <ng-container ngProjectAs="label">
        <ui-icon
          icon="settings"
          [size]="24"
          [uiTooltip]="
            'components.widget.settings.editor.recordSelection' | translate
          "
        ></ui-icon>
        <span>{{
          'components.widget.settings.editor.recordSelection' | translate
        }}</span>
      </ng-container>
      <safe-record-selection-tab
        *ngIf="tileForm"
        [form]="tileForm"
        [selectedResource]="selectedResource"
        [selectedLayout]="selectedLayout"
        (resourceChange)="selectedResource = $event; updateFields()"
        (layoutChange)="selectedLayout = $event; updateFields()"
      ></safe-record-selection-tab>
    </ui-tab>
    <!-- Widget display options -->
    <ui-tab>
      <ng-container ngProjectAs="label">
        <ui-icon
          icon="settings_overscan"
          [size]="24"
          [uiTooltip]="'models.widget.display.title' | translate"
        ></ui-icon>
        <span>{{ 'models.widget.display.title' | translate }}</span>
      </ng-container>
      <safe-display-settings [formGroup]="tileForm"></safe-display-settings>
    </ui-tab>
  </ui-tabs>
</ng-container>
