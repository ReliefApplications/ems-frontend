<ng-container *ngIf="canUpdate; else defaultTemplate">
  <div class="flex items-center" *ngIf="!collapsed">
    <!-- Widget tooltip -->
    <ui-button
      *ngIf="widget.settings?.widgetDisplay?.showTooltip"
      [isIcon]="true"
      icon="info"
      variant="grey"
      [uiTooltip]="widget.settings.widgetDisplay.tooltip"
    ></ui-button>
    <!-- Widget settings -->
    <ui-button
      [isIcon]="true"
      icon="insert_chart"
      [uiTooltip]="'common.settings' | translate"
      (click)="onClick('settings')"
      [disabled]="!this.widget || !this.widget.settings"
      variant="grey"
    ></ui-button>
    <!-- Widget styling  -->
    <ui-button
      [isIcon]="true"
      icon="palette"
      [uiTooltip]="'components.widget.styling' | translate"
      (click)="onClick('style')"
      variant="grey"
    ></ui-button>
    <!-- Expand widget -->
    <ui-button
      *ngIf="!(widget.component === 'map')"
      [isIcon]="true"
      icon="open_in_full"
      [uiTooltip]="'components.widget.expand' | translate"
      (click)="onClick('expand')"
      variant="grey"
    ></ui-button>
    <!-- Delete widget -->
    <ui-button
      [isIcon]="true"
      icon="delete"
      [uiTooltip]="'common.delete' | translate"
      (click)="onClick('delete')"
      variant="danger"
    ></ui-button>
  </div>

  <!-- Widget tooltip -->
  <div *ngIf="collapsed" class="flex items-center">
    <ui-button
      *ngIf="widget.settings?.widgetDisplay?.showTooltip"
      [isIcon]="true"
      icon="info"
      variant="grey"
      [uiTooltip]="widget.settings.widgetDisplay.tooltip"
    ></ui-button>
    <!-- Only display if we have space to do it -->
    <ui-button
      [isIcon]="true"
      icon="more_vert"
      [uiMenuTriggerFor]="menu"
      variant="grey"
      [uiTooltip]="'common.options' | translate"
    ></ui-button>
  </div>
  <ui-menu #menu>
    <!-- Widget settings -->
    <button
      uiMenuItem
      (click)="onClick('settings')"
      [disabled]="!this.widget || !this.widget.settings"
    >
      <ui-icon icon="insert_chart" variant="grey"></ui-icon>
      <span>{{ 'common.settings' | translate }}</span>
    </button>
    <!-- Widget styling  -->
    <button uiMenuItem (click)="onClick('style')">
      <ui-icon icon="palette" variant="grey"></ui-icon>
      <span>{{ 'components.widget.styling' | translate }}</span>
    </button>
    <!-- Expand widget -->
    <button
      uiMenuItem
      (click)="onClick('expand')"
      *ngIf="!(widget.component === 'map')"
    >
      <ui-icon icon="open_in_full" variant="grey"></ui-icon>
      <span>{{ 'components.widget.expand' | translate }}</span>
    </button>
    <!-- Delete widget -->
    <ui-divider class="py-1"></ui-divider>
    <button uiMenuItem (click)="onClick('delete')">
      <ui-icon icon="delete" variant="danger"></ui-icon>
      <span>{{ 'common.delete' | translate }}</span>
    </button>
  </ui-menu>
</ng-container>

<ng-template #defaultTemplate>
  <!-- Widget tooltip -->
  <ui-button
    *ngIf="widget.settings?.widgetDisplay?.showTooltip && collapsed"
    [isIcon]="true"
    icon="info"
    variant="grey"
    [uiTooltip]="widget.settings.widgetDisplay.tooltip"
  ></ui-button>
  <!-- Expand widget -->
  <ui-button
    *ngIf="!(widget.component === 'map')"
    [isIcon]="true"
    icon="open_in_full"
    [uiTooltip]="'components.widget.expand' | translate"
    (click)="onClick('expand')"
    variant="grey"
  ></ui-button>
</ng-template>
