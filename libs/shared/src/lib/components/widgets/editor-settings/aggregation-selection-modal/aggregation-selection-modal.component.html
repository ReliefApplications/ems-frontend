<ui-dialog size="fullscreen">
  <ng-container ngProjectAs="header">
    <h3 class="font-semibold">
      Aggregation select modal
    </h3>
  </ng-container>
  <ng-container ngProjectAs="content">

    <form [formGroup]="formGroup" class="flex flex-col gap-8">
      <!-- Resource selection -->
      <div uiFormFieldDirective class="flex-1">
          <label>{{ 'common.resource.one' | translate }}</label>
          <ui-graphql-select
            valueField="id"
            textField="name"
            [query]="resourcesQuery"
            formControlName="resource"
            [selectedElements]="[selectedResource]"
            (searchChange)="onResourceSearchChange($event)"
            [filterable]="true"
          ></ui-graphql-select>
      </div>
      <div class="flex flex-col mt-8 gap-8" *ngIf="formGroup.get('resource')?.value">
          <!-- Aggregations -->
          <div>
              <h2>{{ 'common.aggregation.one' | translate }}</h2>
          </div>
          <ng-container *ngIf="!selectedAggregation">
            <div class="flex justify-center mt-4">
              <ui-button
              category="tertiary"
              variant="primary"
              (click)="addAggregation()"
              >{{ 'components.aggregation.add.title' | translate }}</ui-button
              >
          </div>
          </ng-container>
      </div>

      <!-- FROM AGGREGATIONS -->
    <ng-container
      *ngIf="selectedAggregation && formGroup.get('resource')?.value"
    >
    <div uiFormFieldDirective>
      <label>{{ 'common.aggregation.one' | translate }}</label>
      <ui-select-menu [disabled]="true" [value]="selectedAggregation.id">
        <ui-select-option [value]="selectedAggregation.id">{{
          selectedAggregation.name
        }}</ui-select-option>
      </ui-select-menu>
      <ui-button
        uiSuffix
        variant="primary"
        [isIcon]="true"
        icon="edit"
        (click)="editAggregation()"
        [uiTooltip]="'common.edit' | translate"
      ></ui-button>
      <ui-button
        uiSuffix
        variant="danger"
        [isIcon]="true"
        icon="close"
        (click)="
          formGroup.get('card.aggregation')?.setValue(null);
          selectedAggregation = null;
        "
        [uiTooltip]="'common.remove' | translate"
      ></ui-button>
    </div>
    </ng-container>
  </form>

  </ng-container>
  <ng-container ngProjectAs="actions">
    <ui-button uiDialogClose variant="default">
      {{ 'common.close' | translate }}
    </ui-button>
    <ui-button
      category="secondary"
      variant="primary"
      (click)="onSubmit()"
      cdkFocusInitial
      [disabled]="!formGroup.valid"
    >
      {{ 'common.save' | translate }}
    </ui-button>
  </ng-container>
</ui-dialog>
  