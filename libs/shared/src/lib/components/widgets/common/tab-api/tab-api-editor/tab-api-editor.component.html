<ui-dialog size="big">
  <ng-container ngProjectAs="header">
    <h3 class="font-semibold">
      {{
        (data
          ? 'models.widget.automation.edit'
          : 'models.widget.automation.create'
        ) | translate
      }}
    </h3>
  </ng-container>
  <ng-container ngProjectAs="content">
    <form [formGroup]="automationRuleForm" class="flex flex-col">
      <div uiFormFieldDirective>
        <label>{{ 'models.widget.automation.name' | translate }}</label>
        <input
          formControlName="name"
          type="text"
          [placeholder]="'models.widget.automation.addName' | translate"
        />
      </div>
      <div uiFormFieldDirective>
        <label>{{ 'models.widget.automation.target' | translate }}</label>
        <ui-select-menu formControlName="targetWidget">
          <ui-select-option *ngFor="let option of widgets" [value]="option.id">
            {{ option.name }}
          </ui-select-option>
        </ui-select-menu>
      </div>
      <div [ngSwitch]="selectedWidget?.component">
        <!-- Selection of type of content -->
        <ng-container *ngSwitchCase="'map'">
          <div uiFormFieldDirective>
            <label>{{ 'models.widget.automation.mapLayer' | translate }}</label>
            <ui-select-menu formControlName="layers">
              <ui-select-option
                *ngFor="let option of widgetLayers"
                [value]="option.id"
              >
                {{ option.name }}
              </ui-select-option>
            </ui-select-menu>
          </div>
        </ng-container>
      </div>
      <div uiFormFieldDirective>
        <label>{{ 'models.widget.automation.event' | translate }}</label>
        <ui-select-menu formControlName="event">
          <ui-select-option
            *ngFor="let option of currentEventsToSelect"
            [value]="option"
          >
            {{ option }}
          </ui-select-option>
        </ui-select-menu>
      </div>
    </form>
  </ng-container>
  <ng-container ngProjectAs="actions">
    <ui-button [uiDialogClose] variant="default">{{
      'common.close' | translate
    }}</ui-button>
    <ui-button
      category="secondary"
      variant="primary"
      [uiDialogClose]="automationRuleForm.value"
      cdkFocusInitial
      [disabled]="!automationRuleForm.valid"
    >
      {{ (data ? 'common.update' : 'common.create') | translate }}
    </ui-button>
  </ng-container>
</ui-dialog>
