<div class="flex justify-between">
  <h2>{{ 'models.widget.automation.rules' | translate }}</h2>

  <ui-button
    class="mb-6"
    category="secondary"
    variant="primary"
    (click)="addEditRule()"
  >
    {{ 'models.widget.automation.add' | translate }}
  </ui-button>
</div>
<ng-template #emptyTmpl>
  <shared-empty
    [title]="'models.widget.automation.empty' | translate"
  ></shared-empty>
</ng-template>
<ng-container
  *ngIf="formGroup.get('automationRules')!.value.length > 0; else emptyTmpl"
>
  <form [formGroup]="formGroup">
    <table
      cdk-table
      uiTableWrapper
      [dataSource]="data"
      formArrayName="automationRules"
    >
      <ng-container cdkColumnDef="name">
        <th uiCellHeader *cdkHeaderCellDef>
          {{ 'models.widget.automation.name' | translate }}
        </th>
        <td
          uiCell
          *cdkCellDef="let element; let rowIndex = index"
          [formGroupName]="rowIndex"
        >
          <div uiFormFieldDirective class="!m-0">
            <input [disabled]="true" formControlName="name" />
          </div>
        </td>
      </ng-container>
      <ng-container cdkColumnDef="actions">
        <th uiCellHeader *cdkHeaderCellDef></th>
        <td uiCell *cdkCellDef="let element; let rowIndex = index">
          <div class="flex gap-2 text-neutral-500 justify-end">
            <ui-button
              variant="danger"
              [isIcon]="true"
              icon="delete"
              (click)="removeRow(rowIndex)"
              [uiTooltip]="'models.widget.automation.delete' | translate"
            >
            </ui-button>
            <ui-button
              uiSuffix
              variant="primary"
              [isIcon]="true"
              icon="edit"
              (click)="addEditRule(rowIndex)"
              [uiTooltip]="'common.edit' | translate"
            ></ui-button>
          </div>
        </td>
      </ng-container>
      <tr cdk-header-row *cdkHeaderRowDef="displayedColumnsApps"></tr>
      <tr
        cdk-row
        *cdkRowDef="let row; columns: displayedColumnsApps"
        class="bg-white"
      ></tr>
    </table>
  </form>
</ng-container>
