<div class=" mt-2">
  <input
    id="autocomplete"
    type="text"
    matInput
    [required]="required"
    [placeholder]="placeholder"
    class="relative w-full rounded-md border-0 p-1.5 shadow-sm ring-1 ring-inset ring-primary-300 focus:ring-2 focus:ring-inset focus:ring-primary-400 sm:leading-6"
    (click)="onClick($event)"
    [(ngModel)]="optionSelected.label"
    aria-haspopup="listbox" aria-expanded="true" aria-labelledby="listbox-label"
  >

  <div *ngIf="open">
    <ng-container  
      *ngTemplateOutlet="recursiveOptionsTemplate; context:{ list: options }"  
    ></ng-container> 
  </div>
</div>

<ng-template #recursiveOptionsTemplate let-list="list">
  <ul
    id="autocomplete"
    *ngFor="let item of list; let i = index"
    class=" z-10 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm" tabindex="-1" role="listbox" aria-labelledby="listbox-label" aria-activedescendant="listbox-option-3"
    [ngClass]="{
      'cursor-pointer': !item.children
    }"
    (click)="!item.children ? onSelect(item) : ''"
  >
    {{item.label}}
    <li
      *ngIf="item.children"
      class=" cursor-pointer text-gray-900 relative cursor-default select-none py-2 pl-3 pr-9" id="listbox-option-{{i}}" role="option"
    >
      <ng-container
        *ngTemplateOutlet="recursiveOptionsTemplate; context:{ list: item.children }"
      ></ng-container>
    </li>
  </ul>
</ng-template>
