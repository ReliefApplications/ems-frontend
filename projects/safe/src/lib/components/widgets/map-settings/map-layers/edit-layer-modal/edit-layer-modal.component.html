<safe-modal size="big" [closable]="true">
  <h2 *ngIf="layer">{{layer.name}}</h2>

  <mat-tab-group
  (selectedTabChange)="drawMap()"
  mat-align-tabs="start"
  animationDuration="0ms"
  vertical
  class="grow">
    <!-- LAYER PROPERTIES -->
    <mat-tab>
      <ng-template mat-tab-label>
        <safe-icon
          icon="edit"
          [size]="24"
          matTooltip="{{'components.widget.settings.map.layers.layerProperties.title' | translate }}"
          matTooltipPosition="right">
        </safe-icon>
        <span>{{'components.widget.settings.map.layers.layerProperties.title' | translate}}</span>
      </ng-template>
      <ng-template matTabContent>
        <div  class="flex flex-wrap gap-4 flex-col lg:flex-row lg:h-full">
          <safe-layer-properties
            [form]="form"
            [currentZoom]="currentZoom"
            (formEvent)="form = $event">
          </safe-layer-properties>
          <ng-container *ngTemplateOutlet="mapContent"></ng-container>
        </div>
      </ng-template>
    </mat-tab>
    <!-- DATASOURCE -->
    <mat-tab>
      <ng-template mat-tab-label>
        <safe-icon
          icon="file_copy"
          [size]="24"
          matTooltip="{{'common.datasource' | translate }}"
          matTooltipPosition="right">
        </safe-icon>
        <span>{{'common.datasource' | translate}}</span>
      </ng-template>
      <ng-template matTabContent>
        <div  class="flex flex-wrap gap-4 flex-col lg:flex-row lg:h-full">
          <safe-layer-datasource></safe-layer-datasource>
          <ng-container *ngTemplateOutlet="mapContent"></ng-container>
        </div>
      </ng-template>
    </mat-tab>

  </mat-tab-group>

  <!-- Dialog actions ( cancel / close ) -->
  <div mat-dialog-actions align="end">
    <safe-button mat-dialog-close>{{ 'common.close' | translate }}</safe-button>
    <safe-button
      category="secondary"
      variant="primary"
      [mat-dialog-close]="form.value"
      cdkFocusInitial
      [disabled]="!form.valid"
    >
      {{ (!layer ? 'common.create' : 'common.update') | translate }}
    </safe-button>
  </div>
  <!-- Map section -->
  <ng-template #mapContent >
    <div [id]="mapId" class="lg:flex-1 max-lg:min-w-full h-80 lg:min-h-full">
      <div
        class="invisible group-hover:visible absolute bottom-0 px-1 z-[1000] text-gray-300 text-xs"
      ></div>
    </div>
  </ng-template>
</safe-modal>
