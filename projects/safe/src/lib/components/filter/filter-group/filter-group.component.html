<form [formGroup]="form">
  <!-- HEADER -->
  <div class="filter-group-header">
    <mat-form-field appearance="outline">
      <mat-label>{{
        'components.queryBuilder.filter.logic' | translate
      }}</mat-label>
      <mat-select formControlName="logic">
        <mat-option value="or">{{
          'components.queryBuilder.filter.or' | translate
        }}</mat-option>
        <mat-option value="and">{{
          'components.queryBuilder.filter.and' | translate
        }}</mat-option>
      </mat-select>
    </mat-form-field>
    <safe-button category="tertiary" (click)="addFilter()">
      {{ 'components.queryBuilder.filter.new' | translate }}
    </safe-button>
    <safe-button category="tertiary" (click)="addGroup()">
      {{ 'components.queryBuilder.filter.newGroup' | translate }}
    </safe-button>
    <safe-button
      [isIcon]="true"
      icon="delete"
      variant="danger"
      (click)="delete.emit()"
    >
    </safe-button>
  </div>
  <!-- FILTERS -->
  <div
    formArrayName="filters"
    class="filter-group-filters"
    *ngIf="filters.length > 0"
  >
    <div *ngFor="let filter of filters.controls; let i = index">
      <ng-container *ngIf="filter.value.logic">
        <!-- NESTED FILTER GROUP -->
        <safe-filter-group
          class="filter-group-item"
          [form]="$any(filter)"
          (delete)="deleteFilter(i)"
        ></safe-filter-group>
      </ng-container>
      <ng-container *ngIf="!filter.value.logic">
        <!-- NESTED FILTER ROW -->
        <safe-filter-row
          class="filter-group-item"
          [form]="$any(filter)"
          (delete)="deleteFilter(i)"
        ></safe-filter-row>
      </ng-container>
    </div>
  </div>
</form>
