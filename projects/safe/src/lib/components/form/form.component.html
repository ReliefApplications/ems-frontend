<div class="form-infos">
  <safe-record-summary
    [record]="record"
    [cacheDate]="storageDate"
    (clear)="onClear()"
    (showHistory)="onShowHistory()"
  ></safe-record-summary>
  <safe-form-actions
    [survey]="surveyModel"
    [surveyActive]="surveyActive"
  ></safe-form-actions>
</div>
<mat-tab-group
  animationDuration="0ms"
  [selectedIndex]="selectedTabIndex"
  (selectedIndexChange)="onShowPage($event)"
>
  <mat-tab
    *ngFor="let page of pages$ | async"
    [label]="page.title ? page.title : page.name"
  >
    <ng-template mat-tab-label>
      {{ page.title ? page.title : page.name }}
      <safe-icon
        *ngIf="page.containsErrors"
        icon="error"
        variant="danger"
        [inline]="true"
        [size]="20"
      ></safe-icon>
    </ng-template>
  </mat-tab>
</mat-tab-group>
<div id="formContainer">
  <survey [model]="surveyModel"></survey>
</div>
<div *ngIf="surveyActive" class="survey-navigation">
  <ng-container *ngIf="pages$ | async as pages">
    <safe-button
      *ngIf="pages.length > 1"
      [disabled]="surveyModel.isFirstPage"
      variant="primary"
      (click)="surveyModel.prevPage()"
      >{{ 'common.previous' | translate }}</safe-button
    >
    <safe-button
      *ngIf="pages.length > 1"
      [disabled]="surveyModel.isLastPage"
      variant="primary"
      (click)="surveyModel.nextPage()"
      >{{ 'common.next' | translate }}</safe-button
    >
  </ng-container>
  <safe-button variant="primary" category="secondary" (click)="submit()">{{
    'common.save' | translate
  }}</safe-button>
</div>
