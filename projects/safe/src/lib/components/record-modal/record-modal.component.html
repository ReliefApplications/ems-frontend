<safe-button mat-dialog-close (click)="onClose()" [isIcon]="true" icon="close" variant="danger" class="modal-close"></safe-button>
<ng-container *ngIf="!loading">
    <div mat-dialog-title>
        <mat-tab-group animationDuration="0ms" [selectedIndex]="selectedTabIndex" (selectedIndexChange)="onShowPage($event)">
            <mat-tab *ngFor="let page of pages$ | async" [label]="page.title ? page.title : page.name"></mat-tab>
        </mat-tab-group>
        <div class="versions-info" *ngIf="data.compareTo">
            <div class="version-info">
                <div>Past version</div>
                <span>{{ data.compareTo.createdAt | date:'dd/MM/yy, h:mm a' }}</span>
            </div>
            <div class="version-info">
                <div>Current version</div>
                <span>{{ record.modifiedAt | date:'dd/MM/yy, h:mm a' }}</span>
            </div>
        </div>
    </div>
</ng-container>
<mat-dialog-content>
    <ng-container *ngIf="!data.compareTo">
        <div mat-dialog-title  *ngIf="modifiedAt" class="history">
          <safe-button [isIcon]="true" icon="history" (click)="onViewHistory(record?.id)">
          </safe-button>
          <div>
            <span>Created by: {{record?.createdBy?.name}} at : {{record?.createdAt | date:'dd/MM/yy, h:mm a'}}</span>
            <span>Last modified by: {{record?.modifiedBy?.name}} on : {{record?.modifiedAt | date:'dd/MM/yy, h:mm a'}}</span>
          </div>
        </div>
        <div [id]="containerId"></div>
    </ng-container>
    <ng-container *ngIf="data.compareTo">
        <mat-grid-list cols="2" rowHeight="2:1">
            <mat-grid-tile [id]="containerNextId">
            </mat-grid-tile>
            <mat-grid-tile [id]="containerId">
            </mat-grid-tile>
        </mat-grid-list>
    </ng-container>
</mat-dialog-content>
<mat-dialog-actions align="end" *ngIf="!loading && data.compareTo">
    <button mat-button (click)="onClose()">Close</button>
    <button mat-flat-button mat-dialog-close="true" cdkFocusInitial color="primary">Revert to past record</button>
</mat-dialog-actions>
<mat-dialog-actions align="end" *ngIf="!loading && !data.compareTo && canEdit">
    <button mat-button color="warn" (click)="onClose()">Close</button>
    <button *ngIf="!survey.isFirstPage" mat-button color="primary" (click)="survey.prevPage()">Previous</button>
    <button *ngIf="!survey.isLastPage" mat-button color="primary" (click)="survey.nextPage()">Next</button>
    <button mat-flat-button color="primary" (click)="onEdit()">Edit record</button>
</mat-dialog-actions>
