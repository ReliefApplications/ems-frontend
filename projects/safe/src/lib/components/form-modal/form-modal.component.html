<safe-button
  (click)="onClose()"
  [isIcon]="true"
  icon="close"
  variant="danger"
  class="modal-close"
></safe-button>
<mat-spinner diameter="45" class="page-loader" *ngIf="loading"></mat-spinner>
<ng-container *ngIf="!loading">
  <safe-record-summary
    *ngIf="record"
    [record]="record"
    (showHistory)="onShowHistory()"
  ></safe-record-summary>
  <div mat-dialog-title>
    <mat-tab-group
      animationDuration="0ms"
      [selectedIndex]="selectedTabIndex"
      (selectedIndexChange)="onShowPage($event)"
    >
      <mat-tab
        *ngFor="let page of pages$ | async"
        [label]="page.title ? page.title : page.name"
      >
        <ng-template mat-tab-label>
          {{ page.title ? page.title : page.name }}
          <safe-icon
            *ngIf="page.containsErrors"
            icon="error"
            variant="danger"
            [inline]="true"
            [size]="20"
          ></safe-icon>
        </ng-template>
      </mat-tab>
    </mat-tab-group>
  </div>
</ng-container>
<mat-dialog-content #formContainer></mat-dialog-content>
<mat-dialog-actions align="end">
  <button mat-button color="warn" (click)="onClose()">
    {{ 'common.cancel' | translate }}
  </button>
  <ng-container *ngIf="pages$ | async as pages">
    <button
      *ngIf="pages.length > 1"
      [disabled]="!survey || survey.isFirstPage"
      mat-button
      color="primary"
      (click)="survey && survey.prevPage()"
    >
      {{ 'common.previous' | translate }}
    </button>
    <button
      *ngIf="pages.length > 1"
      [disabled]="!survey || survey.isLastPage"
      mat-button
      color="primary"
      (click)="survey && survey.nextPage()"
    >
      {{ 'common.next' | translate }}
    </button>
  </ng-container>
  <button mat-flat-button color="primary" (click)="submit()">
    {{ 'components.record.modal.update' | translate }}
  </button>
</mat-dialog-actions>
