<div
  class="flex gap-2 sm:items-center flex-col sm:flex-row mb-8 sm:justify-between"
>
  <!-- Filters -->
  <mat-form-field appearance="outline" class="mat-form-field-sm p-0">
    <mat-icon matPrefix>search</mat-icon>
    <mat-label>{{ 'common.placeholder.search' | translate }}</mat-label>
    <input
      matInput
      [ngModel]="searchText"
      (keyup)="applyFilter('', $event)"
      type="search"
    />
  </mat-form-field>
  <!-- Actions -->
  <safe-button
    icon="add"
    category="secondary"
    variant="primary"
    class="self-end sm:self-start"
    (click)="onAdd()"
    *ngIf="canAdd"
  >
    {{ 'models.referenceData.add' | translate }}
  </safe-button>
</div>

<!-- Table container -->
<div class="overflow-x-hidden -my-0.5 -mx-1.5">
  <!-- Table scroll container -->
  <div class="overflow-auto py-0.5 px-1.5">
    <table *ngIf="!loading" mat-table [dataSource]="dataSource" matSort>
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef>
          <span class="headerTitle" mat-sort-header>
            {{ 'common.name' | translate }}
          </span>
        </th>
        <td mat-cell *matCellDef="let element">{{ element.name }}</td>
      </ng-container>

      <ng-container matColumnDef="type">
        <th mat-header-cell *matHeaderCellDef>
          <span class="headerTitle" mat-sort-header>
            {{ 'pages.referenceData.type' | translate }}
          </span>
        </th>
        <td mat-cell *matCellDef="let element">{{ element.type }}</td>
      </ng-container>

      <ng-container matColumnDef="apiConfiguration">
        <th mat-header-cell *matHeaderCellDef>
          <span class="headerTitle" mat-sort-header>
            {{ 'common.apiConfiguration.one' | translate }}
          </span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.apiConfiguration ? element.apiConfiguration.name : '' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="modifiedAt">
        <th mat-header-cell *matHeaderCellDef>
          <span class="headerTitle" mat-sort-header>
            {{ 'common.modifiedOn' | translate }}
          </span>
        </th>
        <td mat-cell *matCellDef="let element">
          {{ element.modifiedAt | safeDate: 'medium' }}
        </td>
      </ng-container>

      <ng-container matColumnDef="actions" [stickyEnd]="true">
        <th mat-header-cell *matHeaderCellDef></th>
        <td mat-cell *matCellDef="let element">
          <safe-button
            [isIcon]="true"
            icon="more_vert"
            [matMenuTriggerFor]="menu"
            (click)="$event.stopPropagation()"
            [disabled]="!(element.canUpdate || element.canDelete)"
          >
          </safe-button>
          <mat-menu #menu="matMenu">
            <button
              mat-menu-item
              (click)="onDelete(element, $event)"
              *ngIf="element.canDelete"
            >
              <mat-icon>delete</mat-icon>
              {{ 'common.delete' | translate }}
            </button>
          </mat-menu>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr
        mat-row
        *matRowDef="let row; columns: displayedColumns"
        class="cursor-pointer"
        [routerLink]="['/referencedata', row.id]"
      ></tr>
    </table>
  </div>
</div>
<safe-skeleton-table
  *ngIf="loading"
  [columns]="[
    'common.name',
    'pages.referenceData.type',
    'common.apiConfiguration.one',
    'common.modifiedOn'
  ]"
  [actions]="true"
>
</safe-skeleton-table>
<mat-paginator
  [disabled]="loading"
  [pageSize]="pageInfo.pageSize"
  [pageSizeOptions]="[10, 25, 50]"
  [length]="pageInfo.length"
  aria-label="Select page of forms"
  (page)="onPage($event)"
>
</mat-paginator>
