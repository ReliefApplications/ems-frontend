<div class="self-end">
  <ui-button
    [variant]="btnVariant.PRIMARY"
    class="actions"
    [category]="btnCategory.SECONDARY"
    (click)="onAddCalculatedField()"
  >
    {{ 'components.calculatedFields.add' | translate }}</ui-button
  >
</div>
<div>
  <div class="overflow-x-hidden shadow-2lg">
    <div class="overflow-x-auto">
      <table mat-table [dataSource]="fields">
        <ng-container matColumnDef="name">
          <th mat-header-cell *matHeaderCellDef>
            {{ 'models.form.field.name' | translate }}
          </th>
          <td mat-cell *matCellDef="let element">{{ element.name }}</td>
        </ng-container>

        <ng-container matColumnDef="createdAt">
          <th mat-header-cell *matHeaderCellDef>
            {{ 'components.calculatedFields.expression' | translate }}
          </th>
          <td mat-cell *matCellDef="let element">
            {{ element.expression }}
          </td>
        </ng-container>

        <ng-container matColumnDef="_actions" [stickyEnd]="true">
          <th mat-header-cell *matHeaderCellDef class="w-16"></th>
          <td mat-cell *matCellDef="let element">
            <ui-button
              [isIcon]="true"
              icon="more_vert"
              [uiMenuTriggerFor]="resMenu"
              (click)="$event.stopPropagation()"
              [disabled]="!resource.canUpdate"
            >
            </ui-button>
            <ui-menu #resMenu>
              <button uiMenuItem (click)="onEditCalculatedField(element)">
                <mat-icon>edit</mat-icon>
                {{ 'common.edit' | translate }}
              </button>
              <button uiMenuItem (click)="onDeleteCalculatedField(element)">
                <mat-icon>delete</mat-icon>
                {{ 'common.delete' | translate }}
              </button>
            </ui-menu>
          </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
      </table>
    </div>
    <safe-empty
      class="m-auto py-6 px-0 bg-white"
      *ngIf="fields.length === 0"
      [title]="'components.resource.empty.calculatedFields' | translate"
    ></safe-empty>
  </div>
</div>
